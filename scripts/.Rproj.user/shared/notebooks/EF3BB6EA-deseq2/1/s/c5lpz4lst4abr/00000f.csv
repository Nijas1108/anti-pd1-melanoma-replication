"0","library(dplyr)"
"0","library(tidyr)"
"0",""
"0","# Ensure metadata is aligned to vst_sym columns"
"0","meta_plot <- meta_min[colnames(vst_sym), , drop = FALSE]"
"0","stopifnot(all(rownames(meta_plot) == colnames(vst_sym)))"
"0",""
"0","# Keep only genes present"
"0","genes_present <- intersect(genes_to_plot, rownames(vst_sym))"
"0",""
"0","plot_df <- as.data.frame(t(vst_sym[genes_present, , drop = FALSE]))"
"0","plot_df$sample <- rownames(plot_df)"
"0","plot_df$response <- meta_plot$response_bin"
"0",""
"0","plot_long <- plot_df %>%"
"0","  pivot_longer(cols = all_of(genes_present), names_to = ""gene"", values_to = ""expr"")"
"0",""
