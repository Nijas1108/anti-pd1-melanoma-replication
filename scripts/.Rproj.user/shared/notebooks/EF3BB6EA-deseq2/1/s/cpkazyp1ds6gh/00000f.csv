"0",""
"0","ens <- gsub(""\\..*"", """", rownames(vst_mat))"
"0","head(ens)"
"1","[1]"
"1"," ""ENSG00000310526"""
"1"," ""ENSG00000241860"""
"1"," ""ENSG00000308579"""
"1"," ""ENSG00000268903"""
"1"," ""ENSG00000269981"""
"1","
"
"1","[6]"
"1"," ""ENSG00000310527"""
"1","
"
"0","library(AnnotationDbi)"
"0","library(org.Hs.eg.db)"
"0",""
"0","symbols <- mapIds("
"0","  org.Hs.eg.db,"
"0","  keys = ens,"
"0","  keytype = ""ENSEMBL"","
"0","  column = ""SYMBOL"","
"0","  multiVals = ""first"""
"0",")"
"0",""
"0","# Keep only mapped genes"
"0","keep_sym <- !is.na(symbols)"
"0","vst_sym <- vst_mat[keep_sym, ]"
"0","rownames(vst_sym) <- symbols[keep_sym]"
"0",""
"0","# If multiple Ensembl IDs map to same symbol, keep the one with highest average expression"
"0","avg_expr <- rowMeans(vst_sym)"
"0","vst_sym <- vst_sym[order(avg_expr, decreasing = TRUE), ]"
"0","vst_sym <- vst_sym[!duplicated(rownames(vst_sym)), ]"
"0",""
