"0","library(ComplexHeatmap)"
"0","library(circlize)"
"0",""
"0","# Top annotation bar"
"0","top_ha <- HeatmapAnnotation("
"0","  Response = grp[sample_order],"
"0","  col = list(Response = c(""Non-responding"" = ""red"", ""Responding"" = ""blue"")),"
"0","  show_annotation_name = FALSE"
"0",")"
"0",""
"0","pdf(""DEG_heatmap.pdf"", width = 10, height = 6)"
"0",""
"0","ht <- Heatmap("
"0","  mat_z,"
"0","  name = ""Row Z-score"","
"0","  col = colorRamp2(c(-2, 0, 2), c(""green"", ""black"", ""red"")),  # match the example style"
"0","  top_annotation = top_ha,"
"0",""
"0","  cluster_rows = TRUE,"
"0","  cluster_columns = FALSE,              # keep Non-responding left, Responding right"
"0","  column_split = grp[sample_order],"
"0",""
"0","  column_title = c("
"0","    paste0(""Non-responding (n="", sum(grp == ""Non-responding""), "")""),"
"0","    paste0(""Responding (n="", sum(grp == ""Responding""), "")"")"
"0","  ),"
"0",""
"0","  show_column_names = FALSE,"
"0","  row_names_side = ""right"","
"0","  row_names_gp = grid::gpar(fontface = ""italic""),"
"0","  heatmap_legend_param = list(at = c(-2, -1, 0, 1, 2))"
"0",")"
"0",""
"0","draw(ht, heatmap_legend_side = ""left"", annotation_legend_side = ""left"")"
