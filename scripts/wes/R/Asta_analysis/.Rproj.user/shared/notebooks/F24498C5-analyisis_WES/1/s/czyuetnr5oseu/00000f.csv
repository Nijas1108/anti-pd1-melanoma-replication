"0","patient_anno <- final_plotting_df %>%"
"0","  group_by(Patient.ID) %>%"
"0","  summarise("
"0","    resp_group = first(resp_group),"
"0","    nsSNV = max(nsSNV, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","onc_df <- gene_patient %>%"
"0","  filter(Gene %in% sig_genes) %>%"
"0","  mutate(Mutated = 1L) %>%"
"0","  select(Gene, Patient.ID, Mutated) %>%"
"0","  distinct() %>%"
"0","  tidyr::complete(Gene, Patient.ID, fill = list(Mutated = 0L)) %>%"
"0","  left_join(patient_anno, by = ""Patient.ID"")"
"0",""
"0","patient_order <- onc_df %>%"
"0","  distinct(Patient.ID, resp_group, nsSNV) %>%"
"0","  arrange(resp_group, desc(nsSNV)) %>%"
"0","  pull(Patient.ID)"
"0",""
"0","onc_df <- onc_df %>%"
"0","  mutate("
"0","    Patient.ID = factor(Patient.ID, levels = patient_order),"
"0","    Gene = factor(Gene, levels = rev(sig_genes))  # top gene appears at top"
"0","  )"
