"0","library(purrr)"
"0",""
"0","fisher_tbl <- gene_wide2 %>%"
"0","  rowwise() %>%"
"0","  mutate("
"0","    p = fisher.test(matrix("
"0","      c(mut_R,  tot_R - mut_R,"
"0","        mut_NR, tot_NR - mut_NR),"
"0","      nrow = 2, byrow = TRUE"
"0","    ))$p.value"
"0","  ) %>%"
"0","  ungroup() %>%"
"0","  mutate(p_adj = p.adjust(p, method = ""fdr""))"
"0",""
"0","sig_genes <- fisher_tbl %>%"
"0","  mutate("
"0","    freq_R  = mut_R / tot_R,"
"0","    freq_NR = mut_NR / tot_NR,"
"0","    diff = abs(freq_R - freq_NR)"
"0","  ) %>%"
"0","  arrange(desc(diff), p) %>%"
"0","  slice_head(n = 40) %>%"
"0","  pull(Gene)"
