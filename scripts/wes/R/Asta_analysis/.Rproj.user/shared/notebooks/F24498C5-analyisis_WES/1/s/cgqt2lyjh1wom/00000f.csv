"0","ns_classes <- c("
"0","  ""Missense_Mutation"", ""Nonsense_Mutation"","
"0","  ""Splice_Site"", ""Translation_Start_Site"","
"0","  ""Frame_Shift_Del"", ""Frame_Shift_Ins"","
"0","  ""In_Frame_Del"", ""In_Frame_Ins"""
"0",")"
"0",""
"0","mut_df <- merged_maf@data %>%"
"0","  filter(Variant_Classification %in% ns_classes) %>%"
"0","  left_join("
"0","    final_plotting_df %>% select(Tumor_Sample_Barcode, Patient.ID, resp_group),"
"0","    by = ""Tumor_Sample_Barcode"""
"0","  )"
"0",""
"0","library(tidyr)"
"0",""
"0","# 1) presence/absence per patient per gene"
"0","gene_patient <- mut_df %>%"
"0","  distinct(Gene = Hugo_Symbol, Patient.ID, resp_group) %>%"
"0","  filter(!is.na(resp_group))"
"0",""
"0","# 2) count mutated patients per gene per group (fill missing groups with 0)"
"0","gene_counts <- gene_patient %>%"
"0","  count(Gene, resp_group, name = ""n_mut"") %>%"
"0","  tidyr::complete(Gene, resp_group, fill = list(n_mut = 0))"
"0",""
"0","# 3) group sizes"
"0","group_sizes <- final_plotting_df %>%"
"0","  distinct(Patient.ID, resp_group) %>%"
"0","  count(resp_group, name = ""n_total"")"
"0",""
"0","# 4) wide format: one row per gene, with counts in each group"
"0","# make mutation counts wide"
"0","gene_wide_mut <- gene_counts %>%"
"0","  mutate(resp_group = paste0(resp_group, ""_mut"")) %>%"
"0","  pivot_wider(names_from = resp_group, values_from = n_mut)"
"0",""
"0","# make totals wide"
"0","gene_wide_tot <- group_sizes %>%"
"0","  mutate(resp_group = paste0(resp_group, ""_tot"")) %>%"
"0","  pivot_wider(names_from = resp_group, values_from = n_total)"
"0",""
"0","# combine"
"0","gene_wide2 <- gene_wide_mut %>%"
"0","  left_join(gene_wide_tot, by = character())"
"0",""
"0","# check column names"
"0","names(gene_wide2)"
"1","[1]"
"1"," ""Gene""              "
"1"," ""Non-responding_mut"""
"1"," ""Responding_mut""    "
"1"," ""Non-responding_tot"""
"1","
"
"1","[5]"
"1"," ""Responding_tot""    "
"1","
"
"0","gene_wide2 <- gene_wide2 %>%"
"0","  rename("
"0","    mut_R  = `Responding_mut`,"
"0","    mut_NR = `Non-responding_mut`,"
"0","    tot_R  = `Responding_tot`,"
"0","    tot_NR = `Non-responding_tot`"
"0","  )"
