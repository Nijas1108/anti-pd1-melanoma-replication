"0","#Create df with TMB"
"0","# 1. Load callable base summary"
"0","# Format: Tumor_Sample_Barcode, Matched_Norm_Sample_Barcode, Total_Bases, Total_MB"
"0","tmb_df <- read.delim(""/rds/projects/e/elhamsak-group5/main_project/scripts/wes/R/aish_analysis/all_samples_callable_bases.txt"","
"0","                          header = FALSE, stringsAsFactors = FALSE)"
"0","colnames(tmb_df) <- c(""Tumor_Sample_Barcode"", ""Matched_Norm_Sample_Barcode"", ""Total_Bases"", ""Callable_Mb"")"
"0",""
"0","# filter out low coverage samples"
"0","min_callable_mb <- 50"
"0","tmb_df <- tmb_df %>% filter(Callable_Mb >= min_callable_mb)"
"0",""
"0","# 2. Merge nsSNV and non-silent variant counts"
"0","tmb_df <- tmb_df %>%"
"0","  left_join(nsSNV_counts, by = ""Tumor_Sample_Barcode"") %>%"
"0","  left_join(non_silent_counts, by = ""Tumor_Sample_Barcode"")"
"0",""
"0","# 3. Merge author data"
"0","tmb_df <- tmb_df %>%"
"0","  left_join(author_data_mapped, by = ""Tumor_Sample_Barcode"")"
"0",""
"0","# 4. Calculate TMB"
"0","# TMB = nsSNV / Callable Mb"
"0","tmb_df <- tmb_df %>%"
"0","  mutate(TMB = nsSNV / Callable_Mb)"
"0",""
"0","# 5. Rearrange columns"
"0","tmb_df <- tmb_df %>%"
"0","  select("
"0","    Tumor_Sample_Barcode,"
"0","    Matched_Norm_Sample_Barcode,"
"0","    nsSNV,"
"0","    all_nonsilent_vars,"
"0","    TotalNonSyn,"
"0","    TotalNonSyn_Exp,"
"0","    Total_Bases,"
"0","    Callable_Mb,"
"0","    TMB"
"0","  )"
"0",""
"0","# 6. Inspect"
"0","head(tmb_df)"
