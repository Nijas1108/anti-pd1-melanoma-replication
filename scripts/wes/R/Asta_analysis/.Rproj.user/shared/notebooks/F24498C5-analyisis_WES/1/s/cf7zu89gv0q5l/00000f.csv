"0","kmB_df <- final_plotting_df %>%"
"0","  mutate("
"0","    Overall.Survival = as.numeric(Overall.Survival),"
"0","    time_years = Overall.Survival / 365.25,"
"0",""
"0","    Vital.Status = tolower(trimws(as.character(Vital.Status))),"
"0","    event = case_when("
"0","      Vital.Status == ""dead""  ~ 1,"
"0","      Vital.Status == ""alive"" ~ 0,"
"0","      TRUE ~ NA_real_"
"0","    ),"
"0",""
"0","    Response = trimws(as.character(Response)),"
"0","    resp_group = case_when("
"0","      Response == ""R""  ~ ""Responding"","
"0","      Response == ""NR"" ~ ""Non-responding"","
"0","      TRUE ~ NA_character_"
"0","    )"
"0","  ) %>%"
"0","  filter(!is.na(time_years), !is.na(event), !is.na(resp_group)) %>%"
"0","  mutate(resp_group = factor(resp_group, levels = c(""Non-responding"", ""Responding""))) %>%"
"0","  filter(Patient.ID != ""Pt8"")"
"0",""
"0","fitB <- survfit(Surv(time_years, event) ~ resp_group, data = kmB_df)"
"0","sdB  <- survdiff(Surv(time_years, event) ~ resp_group, data = kmB_df)"
"0","pB   <- 1 - pchisq(sdB$chisq, df = 1)"
"0",""
"0","# Save (headless-safe)"
"0","ragg::agg_png(""figure_B.png"", width = 6, height = 5, units = ""in"", res = 300)"
"0",""
"0","plot("
"0","  fitB,"
"0","  col = c(""red"", ""blue""),"
"0","  lty = c(2, 3),"
"0","  lwd = 2,"
"0","  mark.time = TRUE,"
"0","  mark = 3,"
"0","  xlab = ""Survival (years)"","
"0","  ylab = ""Fraction surviving"","
"0","  xlim = c(0, 6),"
"0","  ylim = c(0, 1)"
"0",")"
