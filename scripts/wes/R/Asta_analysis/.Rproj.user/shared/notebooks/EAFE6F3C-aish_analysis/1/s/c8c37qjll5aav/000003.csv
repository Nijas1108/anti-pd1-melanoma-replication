"0","```r

# Filter clinical data for this sample
sample_clinical <- subset(getClinicalData(merged_maf), Matched_Norm_Sample_Barcode == \"SRR4289724\")
print(sample_clinical)
```"
"0","```r

head(combined_df)
```"
"0","```r
# Get the summary table
sample_load <- getSampleSummary(merged_maf)

# View the table
# 'total' is your non-synonymous count
print(sample_load[, .(Tumor_Sample_Barcode, total)])
```"
"0","```r
# library(dyplr)
# Extract mutation data to a standard data.frame
maf_df <- as.data.frame(merged_maf@data)

# Extract clinical data to a standard data.frame
clin_df <- as.data.frame(getClinicalData(merged_maf))

maf_with_patient <- maf_df %>%
  left_join(
    clin_df %>% select(Tumor_Sample_Barcode, Patient.ID),
    by = \"Tumor_Sample_Barcode\"
  )

# head(maf_with_patient)
head(maf_with_patient$Patient.ID)
```"
"0","```r
# check the possible variant types present
unique(maf_df$Variant_Type)
```"
"0","```r
# library(dplyr)

ns_classes <- c(
  \"Missense_Mutation\",
  \"Nonsense_Mutation\",
  \"Nonstop_Mutation\",
  \"Splice_Site\",
  \"Translation_Start_Site\"
)

nonsilent_classes <- c(
  ns_classes,
  \"Frame_Shift_Del\", \"Frame_Shift_Ins\",
  \"In_Frame_Del\", \"In_Frame_Ins\"
)

# 1. Calculate SNP-only counts (nsSNV)
snp_counts <- maf_df %>%
  filter(Variant_Type == \"SNP\", 
         Variant_Classification %in% ns_classes) %>%
  count(Tumor_Sample_Barcode, name = \"nsSNV_SNP\")

# 2. Calculate All Non-silent counts (Includes Indels)
all_nonsilent_counts <- maf_df %>%
  filter(Variant_Classification %in% nonsilent_classes) %>%
  count(Tumor_Sample_Barcode, name = \"nsSNV_all\")

# 1. Load the author's data
# (Assuming the file is in your working directory)
author_data <- read.csv(\"Snv_counts.csv\", stringsAsFactors = FALSE)

# Note: If read.csv didn't change the name automatically, 
# we can rename it manually to ensure the join works:
if(\"Patient.ID\" %in% colnames(author_data) == FALSE & \"Patient.ID\" %in% colnames(author_data) == FALSE){
   # This handles cases where the column might be 'Patient.ID' or 'Patient.ID'
   author_data <- author_data %>% rename(Patient.ID = Patient.ID) 
}

# 2. Update your existing nsSNV_by_sample table
nsSNV_by_sample <- snp_counts %>%
  # Join your calculated SNP counts
  left_join(all_nonsilent_counts, by = \"Tumor_Sample_Barcode\") %>%
  # Join your clinical mapping to get Patient.ID
  left_join(clin_df %>% select(Tumor_Sample_Barcode, Patient.ID), by = \"Tumor_Sample_Barcode\") %>%
  # Join the author's original values from the CSV
  left_join(author_data %>% select(Patient.ID, TotalNonSyn, TotalNonSyn_Exp), by = \"Patient.ID\") %>%
  # Organize and sort
  select(Patient.ID, Tumor_Sample_Barcode, nsSNV_SNP, nsSNV_all, auth_TotalNonSyn=TotalNonSyn, auth_TotalNonSyn_Exp=TotalNonSyn_Exp) %>%
  arrange(desc(nsSNV_SNP))

# View the comparison
head(nsSNV_by_sample, 20)

```"
"0","```r
# library(dplyr)

# make a df with patient ID appearing only once
clin_unique <- clin_df %>%
  # Select only the columns we need for the plots
  select(Patient.ID, irRECIST, Vital.Status, Overall.Survival) %>%
  # Remove duplicate rows for the same patient
  distinct(Patient.ID, .keep_all = TRUE)

# Verify it exists now
head(clin_unique)

# 1. Collapse to Patient Level first
patient_data <- nsSNV_by_sample %>%
  group_by(Patient.ID) %>%
  summarise(
    # Average the counts for patients with multiple samples
    avg_nsSNV_all = mean(nsSNV_all, na.rm = TRUE),
    avg_nsSNV_SNP = mean(nsSNV_SNP, na.rm = TRUE)
  ) %>%
  # 2. Calculate TMB (Assuming 38Mb exome)
  mutate(TMB = avg_nsSNV_all / 38) %>%
  # 3. Join with Clinical Data
  left_join(clin_unique, by = \"Patient.ID\")

# 4. Now calculate the median based on the UNIQUE patient list
tmb_median <- median(patient_data$TMB, na.rm = TRUE)

# 5. Create the High/Low groups
patient_data <- patient_data %>%
  mutate(TMB_Group = ifelse(TMB > tmb_median, \"High TMB\", \"Low TMB\"))
```"
"0","```r



# 1. Create the Response labels in your clinical data
clin_unique <- clin_unique %>%
  mutate(Response = case_match(irRECIST,
    \"Complete Response\" ~ \"Responder\",
    \"Partial Response\"  ~ \"Responder\",
    \"Progressive Disease\" ~ \"Non-Responder\",
    .default = NA  # Handles any missing or SD cases
  ))

# 2. Join with your mutation counts (nsSNV_by_sample)
plot_data <- nsSNV_by_sample %>%
  left_join(clin_unique %>% select(Patient.ID, Response), by = \"Patient.ID\") %>%
  filter(!is.na(Response)) # Remove patients with unknown response

# 3. Calculate the percentage for the bar plot
response_summary <- plot_data %>%
  count(Response) %>%
  mutate(percentage = n / sum(n) * 100)
```"
"0","```r
library(dplyr)
library(ggplot2)
library(ggpubr)

# 1. Prepare the 4-group logic
plot_data_1c <- clin_unique %>%
  filter(!is.na(Response)) %>%
  group_by(Response) %>%
  mutate(
    # Calculate median within each group
    group_median = median(avg_nsSNV_all, na.rm = TRUE),
    # Assign High/Low based on that group's median
    Load_Level = ifelse(avg_nsSNV_all >= group_median, \"high nsSNV\", \"low nsSNV\"),
    # Create the final 4-category label for the X-axis
    Group_Label = paste(Response, Load_Level, sep = \"\n\")
  ) %>%
  ungroup()

# 2. Set the order of the X-axis to match the paper
plot_data_1c$Group_Label <- factor(plot_data_1c$Group_Label, levels = c(
  \"Responder\nhigh nsSNV\", 
  \"Responder\low nsSNV\", 
  \"Non-Responder\nhigh nsSNV\", 
  \"Non-Responder\low nsSNV\"
))

# 3. Create the Plot
p1c <- ggplot(plot_data_1c, aes(x = Group_Label, y = avg_nsSNV_all / 1000, fill = Response)) +
  geom_boxplot(outlier.shape = NA, width = 0.6) +
  geom_jitter(width = 0.15, alpha = 0.6, color = \"firebrick\") +
  theme_classic() +
  scale_fill_manual(values = c(\"Responder\" = \"white\", \"Non-Responder\" = \"white\")) + # Matches the clean look
  labs(y = \"Somatic nsSNVs (in 1000s)\", 
       x = \"\", 
       title = \"Figure 1C\") +
  # Adding the p-value comparison between Responding and Non-responding High groups
  stat_compare_means(method = \"wilcox.test\", 
                     comparisons = list(c(\"Responder\nhigh nsSNV\", \"Non-Responder\nhigh nsSNV\")),
                     label = \"p.format\")

# 4. Save the plot
ggsave(\"Figure_1C_Refined.png\", plot = p1c, width = 7, height = 6)
```"
"0","```r
# RECREATING THE PLOT
p1c <- ggplot(response_summary, aes(x = Response, y = n, fill = Response)) +
  geom_bar(stat = \"identity\", width = 0.6) +
  scale_fill_manual(values = c(\"Non-Responder\" = \"#E41A1C\", \"Responder\" = \"#377EB8\")) +
  theme_minimal() +
  labs(title = \"Figure 1C: Clinical Response Distribution\",
       y = \"Number of Patients\",
       x = \"\") +
  theme(legend.position = \"none\")

ggsave(\"Figure_1C_Response_Barplot.png\", plot = p1c, width = 6, height = 4, dpi = 300)

print(\"Plot saved as Figure_1C_Response_Barplot.png\")
```"
"0","```r
p1c2 <- ggplot(plot_data, aes(x = Response, y = log10(nsSNV_all), fill = Response)) +
  geom_boxplot(outlier.shape = NA) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  scale_fill_manual(values = c(\"Non-Responder\" = \"#E41A1C\", \"Responder\" = \"#377EB8\")) +
  theme_classic() +
  labs(y = \"log10(Total Non-silent Mutations)\", 
       title = \"Mutation Load by Response\")

ggsave(\"Figure_1C2_Response_Barplot.png\", plot = p1c2, width = 6, height = 4, dpi = 300)

print(\"Plot saved as Figure_1C2_Response_Barplot.png\")
```"
"0","```r
pt8 <- combined_df %>% filter(Tumor_Sample_Barcode == \"SRR4289715\")
table(pt8$FILTER)




```"
"1","
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYGBgclxucHQ4IDwtIGNvbWJpbmVkX2RmICU+JSBmaWx0ZXIoVHVtb3JfU2FtcGxlX0JhcmNvZGUgPT0gXFxTUlI0Mjg5NzE1XFwpXG50YWJsZShwdDgkRklMVEVSKVxuXG5cblxuXG5gYGBcbmBgYCJ9 -->

```r
```r
pt8 <- combined_df %>% filter(Tumor_Sample_Barcode == \SRR4289715\)
table(pt8$FILTER)




```
```

<!-- rnb-source-end -->
"
"0","```r
```r
pt8 <- combined_df %>% filter(Tumor_Sample_Barcode == \SRR4289715\)
table(pt8$FILTER)




```
```"
