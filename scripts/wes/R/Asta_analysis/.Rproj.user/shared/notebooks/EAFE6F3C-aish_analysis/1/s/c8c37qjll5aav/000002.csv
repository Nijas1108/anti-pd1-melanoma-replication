"1","
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGlicmFyeShtYWZ0b29scylcbmxpYnJhcnkoZHBseXIpXG5saWJyYXJ5KGdncGxvdDIpXG5gYGAifQ== -->

```r
library(maftools)
library(dplyr)
library(ggplot2)
```

<!-- rnb-source-end -->
"
"1","
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYGBgclxubGlicmFyeShtYWZ0b29scylcbmxpYnJhcnkoZHBseXIpXG5saWJyYXJ5KGdncGxvdDIpXG5gYGBcbmBgYCJ9 -->

```r
```r
library(maftools)
library(dplyr)
library(ggplot2)
```
```

<!-- rnb-source-end -->
"
"0","```r
```r
library(maftools)
library(dplyr)
library(ggplot2)
```
```"
"0","```r
# Read clinical metadata into a datafram
clinical_df_og <- read.csv(\"mmc1.csv\", stringsAsFactors = FALSE)

# RENAME the sample ID column to match the MAF sample ID column (Sample_Barcode)
# Check CSV and use the name of the column here:
colnames(clinical_df_og)[colnames(clinical_df_og) == \"SRA.Run.ID..tumor.WES\"] <- \"Tumor_Sample_Barcode\"
colnames(clinical_df_og)[colnames(clinical_df_og) == \"SRA.Run.ID..normal.WES\"] <- \"Matched_Norm_Sample_Barcode\"
```"
"0","```r
# library(maftools)

# 1. Define the two directories
ucla_dir <- \"/rds/projects/e/elhamsak-group5/main_project/annotation/ucla_processed_bed\"
vandy_dir <- \"/rds/projects/e/elhamsak-group5/main_project/annotation/vanderbilt_processed_bed\" 

# Collect all MAF files
maf_files <- c(
  list.files(ucla_dir,  pattern = \"\\.maf$\", full.names = TRUE),
  list.files(vandy_dir, pattern = \"\\.maf$\", full.names = TRUE)
)

cat(\"Total MAF files found:\", length(maf_files), \"\n\")
```"
"0","```r
# Process each MAF
all_mafs_list <- lapply(maf_files, function(file_path) {
  
  dat <- read.delim(file_path, comment.char = \"#\", stringsAsFactors = FALSE)
  
  # Extract both IDs from filename
  fname <- basename(file_path)
  # removes everything starting from the first dot and split by \"_vs_\"
  ids <- unlist(strsplit(clean_name <- gsub(\"\\..*\", \"\", fname), \"_vs_\"))
  
  tumor_id  <- ids[1]
  normal_id <- ids[2]
  
  # Replace BOTH barcodes
  dat$Tumor_Sample_Barcode  <- tumor_id
  dat$Matched_Norm_Sample_Barcode <- normal_id
  
  # Track cohort source
  dat$Cohort <- ifelse(grepl(\"UCLA\", file_path),
                       \"UCLA\",
                       \"VANDERBILT\")
  
  return(dat)
})

# ---- Merge ----
combined_df <- do.call(rbind, all_mafs_list)

```"
"0","```r
colnames(combined_df)
```"
"0","```r
# Compute tumor allele frequency
combined_df$AF <- combined_df$t_alt_count / (combined_df$t_alt_count + combined_df$t_ref_count)
# Keep only variants with AF >= 0.1 (10%)
filtered_df <- combined_df[combined_df$AF >= 0.1, ]

nrow(combined_df)
```"
"0","```r
nrow(filtered_df)
```"
"0","```r
cat(\"Total variants after merge:\", nrow(combined_df), \"\n\")
```"
"0","```r
# ---- Build MAF object ----
merged_maf <- read.maf(maf = combined_df,
                       clinicalData = clinical_df_og)
```"
"0","```r
# Check summary
getSampleSummary(merged_maf)
```"
