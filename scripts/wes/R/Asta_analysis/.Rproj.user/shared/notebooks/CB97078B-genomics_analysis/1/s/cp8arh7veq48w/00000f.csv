"0","library(dplyr)"
"0",""
"0","# 1. Calculate SNP-only counts (nsSNV)"
"0","snp_counts <- maf_df %>%"
"0","  filter(Variant_Type == ""SNP"", "
"0","         Variant_Classification %in% ns_classes) %>%"
"0","  count(Tumor_Sample_Barcode, name = ""nsSNV_SNP"")"
"0",""
"0","# 2. Calculate All Non-silent counts (Includes Indels)"
"0","all_nonsilent_counts <- maf_df %>%"
"0","  filter(Variant_Classification %in% nonsilent_classes) %>%"
"0","  count(Tumor_Sample_Barcode, name = ""nsSNV_all"")"
"0","# "
"0","# # 3. Combine everything with Patient.ID"
"0","# nsSNV_by_sample <- snp_counts %>%"
"0","#   left_join(all_nonsilent_counts, by = ""Tumor_Sample_Barcode"") %>%"
"0","#   left_join(clin_df %>% select(Tumor_Sample_Barcode, Patient.ID), by = ""Tumor_Sample_Barcode"") %>%"
"0","#   select(Patient.ID, Tumor_Sample_Barcode, nsSNV_SNP, nsSNV_all) %>%"
"0","#   arrange(desc(nsSNV_SNP))"
"0","# "
"0","# # View results"
"0","# head(nsSNV_by_sample, 20)"
"0","# "
"0","# library(dplyr)"
"0",""
"0","# 1. Load the author's data"
"0","# (Assuming the file is in your working directory)"
"0","author_data <- read.csv(""../Snv_counts.csv"", stringsAsFactors = FALSE)"
"0",""
"0","# Note: If read.csv didn't change the name automatically, "
"0","# we can rename it manually to ensure the join works:"
"0","if(""Patient.ID"" %in% colnames(author_data) == FALSE & ""Patient.ID"" %in% colnames(author_data) == FALSE){"
"0","   # This handles cases where the column might be 'Patient.ID' or 'Patient.ID'"
"0","   author_data <- author_data %>% rename(Patient.ID = Patient.ID) "
"0","}"
"0",""
"0","# 2. Update your existing nsSNV_by_sample table"
"0","nsSNV_by_sample <- snp_counts %>%"
"0","  # Join your calculated SNP counts"
"0","  left_join(all_nonsilent_counts, by = ""Tumor_Sample_Barcode"") %>%"
"0","  # Join your clinical mapping to get Patient.ID"
"0","  left_join(clin_df %>% select(Tumor_Sample_Barcode, Patient.ID), by = ""Tumor_Sample_Barcode"") %>%"
"0","  # Join the author's original values from the CSV"
"0","  left_join(author_data %>% select(Patient.ID, TotalNonSyn, TotalNonSyn_Exp), by = ""Patient.ID"") %>%"
"0","  # Organize and sort"
"0","  select(Patient.ID, Tumor_Sample_Barcode, nsSNV_SNP, nsSNV_all, auth_TotalNonSyn=TotalNonSyn, auth_TotalNonSyn_Exp=TotalNonSyn_Exp) %>%"
"0","  arrange(desc(nsSNV_SNP))"
"0",""
"0","# View the comparison"
"0","head(nsSNV_by_sample, 20)"
